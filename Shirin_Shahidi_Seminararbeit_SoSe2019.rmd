---
title: "Wie beeinflusst der Goldene Schnitt die Ziehungswahrscheinlichkeit unter zwei Fibonacci-Zahlen im Lotto 6 aus 49?"
author: "Shirin Shahidi, Matrikelnummer 455612"
date: "`r Sys.Date()`"
output:
  pdf_document:
    fig_caption: yes
    latex_engine: xelatex
    fig_height: 3
    fig_width: 5
    toc: yes
  html_document:
    df_print: paged
    toc: yes
  documentclass: article
  classoption: a4paper
  word_document:
    toc: yes
lang: de
editor_options:
  chunk_output_type: console
bibliography: WM-QDA_Seminararbeit.bib
csl: harvard.fh.sb.csl
header-includes: \usepackage{float}
---



```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(fig.path = 'Abbildung/', echo = FALSE, warning = FALSE, message = FALSE, fig.align ="left")

require(mosaic) # Das Paket mosaic wird geladen


```

```{r Library, echo=FALSE, include=FALSE}
library(mosaic)
library(dplyr)
#install.packages("citr")
library(citr)
```
\newpage
# 1. Einleitung
>"Das, wobei unsere Berechnungen versagen, nennen wir Zufall." - Albert Einstein [@zitate.net_zufallzitate_2019, o.S.].

<p>Im deutschen Lotto 6 aus 49 lassen sich Erfolgswahrscheinlichkeiten errechnen, nicht jedoch künftige Ziehungen vorhersagen.
Tendenzen, dass spezifische Ereignisse eintreten, können auf Basis bereits vergangener Ziehungen statistisch ermittelt werden [vgl.@ute_sproesser_et_al._daten_2014, S.33].</p>

>"Etwas hat Gestalt, weil es auf Zahlen beruht[...]" [@jonak_essays_2018, S.136].

<p>Die menschliche Gestaltwahrnehmung bevorzugt Vollkommenheit, Symmetrie und bestimmte Proportionen wie etwa den Goldenen-Schnitt. Diese Wahrnehmungspräferenzen von Gestalten lassen sich auch im Tierreich beobachten, bei dem Gestaltwahrnehmung instinktiv zu einer Reaktion führt[vgl.@oerter_mensch_2014, S.252].</p>   

<p>Auf Basis dieser Tatsachen stellt sich die Frage, ob die Gestalt der Lottoziehungen bestimmte Proportionen bevorzugt oder ob Ziehungen bestimmter Zahlenkombinationen rein zufällig erfolgen. Konzentriert man sich auf die Proportion des Goldenen Schnittes, so wird dieser gemäß aktuellem Forschungsstand durch die Formel $\frac{\sqrt{5} + 1}{2}\sim1,618$ errechnet [vgl.@kohn_mathematik_2019, S. 160]. Leonardo of Pisa, auch unter dem Namen Fibonacci bekannt, veröffentlichte 1202 das Werk *Liber Abbaci*[vgl.@hannah_false_2007, o.S.]. In diesem führt er zur Fibonacci-Sequenz hin, welche im Tierreich die Vermehrung von Hasen in Zahlen beschreibt[vgl.@fibonacci_introduction:_1987, S.18]. Im Lotto 6 aus 49 sind die ersten acht Fibonacci-Zahlen (1,2,3,5,8,13,21,34) enthalten[vgl.@kohn_mathematik_2019, S.159]. Dividiert man zwei aufeinander folgende Fibonacci-Zahlen, so konvergieren diese gegen den Goldene-Schnitt[vgl.@knebl_algorithmen_2019, S.29].</p> 
<p>Um zur Forschungsfrage hinführen zu können, wird im Folgenden auf die beliebteste Lotterie namens Lotto 6 aus 49 unter den Einwohnern Deutschlands eingegangen[vgl.@lotto.de_lotto_2019, o.S.]. Spielberechtigt sind dabei erwachsene Personen ab 18 Jahren, da gemäß Jugendschutzgesetz § 6 Spielhallen, Glücksspiele Minderjährigen das Glücksspiel mit Chance auf hohe Geldbeträge untersagt ist[vgl.@juschg_juschg_2019, o.S.]. Ziel eines Lottospieles ist es 6 zufällig gezogene Gewinnzahlen aus 1-49 vorgegeben Ziffern vorherzusagen. Dabei wird ein Lotto-Schein mit 12 möglichen Tippfeldern und jeweils 49 Zahlen ausgefüllt. Pro Tippfeld werden 6 Zahlen angekreuzt. Jeder Lotto-Schein enthält eine Spielscheinnummer, deren letzte Ziffer die Superzahl darstellt. Diese Superzahl wird neben den 6 Gewinnzahlen zufällig aus den Ziffern 0-9 ermittelt. Es müssen minimal 2 Ziffern und eine Superzahl korrekt prophezeit werden um einen Gewinn zu erzielen. Der maximale Gewinn stellt 6 richtige Gewinnzahlen und die korrekte Superzahl dar. Der halbierte Spieleinsatz stellt die Gewinnsumme dar, welche sich auf 9 Gewinnklassen aufteilen lässt. Zusätzlich können die Lotterien Spiel 77 und SUPER 6 sowie die GlücksSpirale im Lotto-Schein ausgewählt werden. Ein Tippfeld im Lotto 6 aus 49 kostet 1,0€ zzgl. Bearbeitungsgebühren. Die Ziehungen finden wöchentlich mittwochs um 18:25 Uhr und samstags um 19:25 Uhr unter www.lotto.de statt[vgl.@lotto.de_lotto_2019, o.S.]. Die Wahrscheinlichkeit, zwei konkrete Zahlen im Lotto zu ziehen beträgt $1:((\frac{49}{6})*(\frac{48}{5}))\sim0.01276$[vgl.@lottozahlen.com_6_2019, o.S.].</p>

## 1.1. Forschungsfrage
<p>Betrachtet man die bereits genannten Fibonacci Zahlen im Lotto 6 aus 49 und die Konvergenz gegen den Goldenen Schnitt, lässt sich die Forschungsfrage wie folgt ableiten:</p><p>*Wie beeinflusst der Goldene Schnitt die Ziehungswahrscheinlichkeit unter zwei Fibonacci-Zahlen im Lotto 6 aus 49?*</p>
<p>In einer ersten Hypothese soll geprüft werden, ob eine Fibonacci Zahl unter allen Fibonacci-Zahlen im Lotto 6 aus 49 am häufigsten mit ihrer Goldenen-Schnitt Zahl gezogen wird. Im Anschluss daran soll geprüft werden, ob eine Fibonacci Zahl unter allen Fibonacci-Zahlen im Lotto 6 aus 49 am häufigsten mittwochs mit ihrer Goldenen-Schnitt Zahl gezogen wird. Dieser Tag wird mit den Samstagsziehungen und den davon abweichenden Wochentagen verglichen.
Die Hypothesen lassen sich wie folgt formulieren:</p>
<p>*H1: Fibonacci-Zahlen 1,2,21 und 34 werden unter allen Fibonacci-Zahlen im Lotto 6 aus 49 am häufigsten mit ihren Goldenen-Schnitt Zahlen gezogen*</p>
In Form eines Punktschätzers kann H1 wie folgt mathematisch formuliert werden:
<p> *H1: p1 > 0.01276* </p>
<p>*H2: Fibonacci-Zahlen 1,2,21, und 34 werden unter allen Fibonacci-Zahlen im Lotto 6 aus 49 am häufigsten samstags mit ihrer Goldenen-Schnitt Zahl gezogen.*</p>
<p> *H1: p2 > 0.01276* </p>

## 1.2. Ziel der Studie/ Analyse 
Das Untersuchungsziel der Studie ist deskriptiv ausgerichtet mit der Anforderung an exakte Ergebnisse und eine repräsentative Stichprobe sowie der Beschreibung der Grundgesamtheit mit ihren wesentlichen Merkmalen.[vgl.@kus_marktforschung:_2012, S.15] Ziel der Studie soll sein, herauszufinden, ob Fibonacci-Zahlenpaare, die dividiert den Goldenen-Schnitt ergeben im Lotto 6 aus 49 häufiger zusammen gezogen werden als Fibonacci-Zahlenpaare ohne den Goldenen-Schnitt Proportionen. Hierzu sollen nur die Gewinnzahlen ohne Superzahl in Betracht gezogen wereden, da die Superzahlziehung eine abweichende Wahrscheinlichkeit von $\frac{1}{10}$ aufweist. Es werden die Häufigkeiten der Fibonacci-Zahlen, sowie jeglicher Fibonaccipaar-Ziehungen unter allen Lotto-Ziehungen von 1955 bis Ende Juni 2019 betrachtet. Sollte sich herausstellen, dass Zahlenpaare aus dieser Auswahl am häufigsten zusammen auftreten, so werden diese mit Hilfe der Inferenzstatistik genauer betrachtet um einen Einfluss des Goldenen-Schnittes auf diese Zahlenpaare ausfindig machen zu können.

# 2. Methodik
Um die Methodik festlegen zu können, wird auf das Studiendesign, sowie die Datenerhebung und die angewandten statistsichen Methoden genauer Bezug genommen [vgl.@kus_marktforschung:_2012, S.13].

## 2.1. Studiendesign
Das Studiendesign wird definiert durch die Art der Datenerhebung und Ziehung der Stichprobe. Die vorliegende Studie basiert auf den Sekundärforschungen der Westdeutsche Lotterie GmbH & Co. oHG, sowie den Datenerhebungen unter www.lottozahlenonline.de durch Gustav Zygmund. [vgl.@kus_marktforschung:_2012, S.15]

### 2.1.1 Datenerhebung
Da es sich um die Beschreibung der Veränderungen der Lotto-Ziehungen im Zeitablauf von 1955 bis 2019 handelt, wurden die in der Studie verwendeten Sekundärdaten in Form von Längsschnitt-Untersuchungen als Beobachtung erhoben. Da das Forschungsproblem auf Basis von Sekundärdaten bearbeitbar ist, wird in dieser Studie auf die Erhebung von Primärdaten verzichtet. Die bereits vorhandenen Daten werden für die Studie neu aufbereitet und analysiert. [vgl.@kus_marktforschung:_2012, S.16] 

### 2.1.2 Stichprobe
Die erhobenen Sekundärdaten stellen alle Ziehungen seit Anbeginn des Lottos 6 aus 49 von 1955 bis zum Zeitpunkt der Studienanalyse tabellarisch dar. Werden potenzielle Ungenauigkeiten wie etwa Tipp- oder Eingabefehler in den bereits vorhandenen Sekundärdaten vernachlässigt, kann von einer Totalerhebung der Daten ausgegangen werden. Dies führt dazu, dass Stichprobenfehler die Aussagekraft nicht einschränken können.[vgl.@kus_marktforschung:_2012, S.43 f.]

## 2.2 Angewandte statistische Methoden
Um die Daten hinsichtlich ihrer Eignung für statistische Methoden zu überprüfen, wird eine explorative Datenanalyse zur Verdichtung der Daten durchgeführt. Da es sich um Häufigkeitsbeobachtungen der Fibonacci-Zahlenpaare in der Stichprobe handelt, werden Schätzverfahren angewandt, um Annahmen über entsprechende Wahrscheinlichkeitsverteilungen in der Grundgesamtheit treffen zu können [vgl.@kus_marktforschung:_2012, S.193 f.]. Eine Annahme oder Ablehnung der Hypothesen erfolgt mittels der Zweiseitigen Fragestellung [vgl.@hellbruck_angewandte_2009, S.73-76]. Um den Datensatz auf Linearität zu überprüfen wird anschließend eine lineare Regression durchgeführt [vgl.@hellbruck_angewandte_2009, S.250]. Für die Ergebnisse der statistischen Methoden wird die Programmiersprache R verwendet. Diese ermöglicht den Einsatz moderner Verfahren der Datenanalyse und ist reproduzierbar, automatisierbar, quelloffen, kostenlos und grafisch abbildbar. [vgl.@sauer_moderne_2018, S.16 f.] Für den Datensatz wurden die Ergebnisse der Lotto-Ziehungen aus den Quellen Westdeutsche Lotterie GmbH & Co. oH.

 
# 3. Ergebnisse 
Um zu den Ergebnissen der Studie hinführen zu können werden die bereits genannten statistischen Methoden im Folgenden anhand von R-Syntax-Abschnitten (sogenannten Chunks) erklärt, sowie grafisch veranschaulicht [vgl.@sauer_moderne_2018, S.26]. 

## 3.1 Kennzahlen der Stichprobe
Um einen Überblick über die Kennzahlen der Stichprobe zu erhalten, wird die Bibliothek "mosaic" geladen und der R-Befehl "inspect" ausgeführt:
```{r Kennzahlen, echo=FALSE, include=TRUE}
#install.packages('tinytex')
# Dateipfad festlegen
setwd("/Users/shisha/Desktop/WissMethoden_quantitativeDatenanalyse")

#Bibliotheken laden
library("mosaic")
library(dplyr)
library(knitr)

# CSV-Datei laden & Spaltennamen vergeben
data_lotto_orig <- read.csv2("data_lotto_date.csv")
colnames(data_lotto_orig) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")

# Kennzahlen ausspielen lassen
inspect(data_lotto_orig)
```

Die Stichprobe des Datensatzes Lotto 6 aus 49 von 1955 bis 2019 enthält 6 numerisch diskrete und eine kategoriale Variable. Insgesamt enthält die Stichprobe 4295 Beobachtungen. Die numerischen Variablen stellen die Gewinnzahlen kategorisiert nach Ziehungsrunde dar. Das Minimum liegt bei der Ziffer 1 und das Maximum bei Ziffer 49. Die kategoriale Variable nennt den Wochentag, an dem die Beobachtungen aufgezeichnet wurden. Die Lagemaße und Streumaße sind unterschiedlich ausgeprägt, wie anhand der Werte von Quantil 1 und 3 sowie der Mittelwerte und dem Median zu erkennen ist. Die Standardabweichung fällt ebenfalls unterschiedlich aus. Die Variablennamen werden wie folgt ausgegeben: `r names(data_lotto_orig)`. Insgesamt sind keine fehlenden Angaben vorhanden. Einen Überblick über die letzten 6 Beobachtungen des Datensatzes verschafft der Befehl "tail":

```{r, echo=FALSE, include=TRUE}
tail(data_lotto_orig)
```

## 3.2 explorative Statistik
<p>Anhand der explorativen Statistik sollen Häufigkeitsverteilungen der Fibonacci-Zahlen betrachtet werden. Hierzu wird der Datensatz nach Fibonacci-Zahlen mittels R-Skript ("_01_Sort_by_Fibo.R") sortiert und gefiltert. Die daraus gewonnen Daten werden auf Fibonacci-Zahlenpaare im Goldenen-Schnitt Verhältnis und deren Häufigkeitsverteilung überprüft und nach Häufigkeit der Ziehung betrachtet. Dadurch zeigt sich, welche Fibonacci-Zahlen mit welchen Fibonacci-Zahlen am häufigsten gemeinsam in einer Ziehung auftreten (siehe Tabelle 1).</p>

```{r Häufigkeitsverteilung Fibonacci Zahlen - Vorbereitung,echo=FALSE, include=FALSE}
#Sortierte Daten einlesen
Fibo1 <- read.csv2("1_Sort_by_Fibo.csv")
rbind(Fibo1)
Fibo2 <- read.csv2("2_Sort_by_Fibo.csv")
rbind(Fibo2)
Fibo3 <- read.csv2("3_Sort_by_Fibo.csv")
rbind(Fibo3)
Fibo5 <- read.csv2("5_Sort_by_Fibo.csv")
rbind(Fibo5)
Fibo8 <- read.csv2("8_Sort_by_Fibo.csv")
rbind(Fibo8)
Fibo13 <- read.csv2("13_Sort_by_Fibo.csv")
rbind(Fibo13)
Fibo21 <- read.csv2("21_Sort_by_Fibo.csv")
rbind(Fibo21)
Fibo34 <- read.csv2("34_Sort_by_Fibo.csv")
rbind(Fibo34)

#Spaltenüberschriften zuweisen
colnames(Fibo1) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo2) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo3) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo5) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo8) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo13) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo21) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")
colnames(Fibo34) <- c("GewZahl_1", "GewZahl_2","GewZahl_3","GewZahl_4","GewZahl_5","GewZahl_6","Wochentag")

datalength <- nrow(data_lotto_orig)

#Anteile von am häufigsten gemeinsam gezogenen Fibozahlen bestimmen in Form einer Funktion
quota <- function(data1,data2,data3,data4,data5,data6,data7,data8,quelle) {
  #Fibo x mit y [1]
  total_row <- nrow(quelle)
  test1 <- rbind(data1,data2)
  result1 <- which(duplicated(test1))
  length1 <- length(result1)
  quota1 <- (length1)/(total_row)
  #Fibo x mit y [2]
  test2 <- rbind(data1,data3)
  result2 <- which(duplicated(test2))
  length2 <- length(result2)
  quota2 <- (length2)/(total_row)
  #Fibo x mit y [3]
  test3 <- rbind(data1,data4)
  result3 <- which(duplicated(test3))
  length3 <- length(result3)
  quota3 <- (length3)/(total_row)
  #Fibo x mit y [4]
  test4 <- rbind(data1,data5)
  result4 <- which(duplicated(test4))
  length4 <- length(result4)
  quota4 <- (length4)/(total_row)
  #Fibo x mit y [5]
  test5 <- rbind(data1,data6)
  result5 <- which(duplicated(test5))
  length5 <- length(result5)
  quota5 <- (length5)/(total_row)
  #Fibo x mit y [6]
  test6 <- rbind(data1,data7)
  result6 <- which(duplicated(test6))
  length6 <- length(result6)
  quota6 <- (length6)/(total_row)
  #Fibo x mit y [7]
  test7 <- rbind(data1,data8)
  result7 <- which(duplicated(test7))
  length7 <- length(result7)
  quota7 <- (length7)/(total_row)
  total_data <- data.frame(quota1,quota2,quota3,quota4,quota5,quota6,quota7)
  colnames(total_data) <- c("data1+2","data1+3","data1+4","data1+5","data1+6","data1+7","data1+8")
  leng <- data.frame(length1,length2,length3,length4, length5, length6, length7)
  colnames(leng) <- c("data1+2","data1+3","data1+4","data1+5","data1+6","data1+7","data1+8")
  #Fibo <<- sort(total_data)
  print(sort(total_data))
  print(sort(leng))
}

#Inhalte an Funktion übermitteln
Fibo_1 <- quota(Fibo1,Fibo2,Fibo3,Fibo5,Fibo8,Fibo13, Fibo21, Fibo34,data_lotto_orig)
Fibo_1
colnames(Fibo_1) <- c("1&13","1&34","1&8","1&5","1&21","1&3","1&2")

Fibo_2 <- quota(Fibo2,Fibo1,Fibo3,Fibo5,Fibo8,Fibo13, Fibo21, Fibo34,data_lotto_orig)
Fibo_2
colnames(Fibo_2) <- c("2&13","2&5","2&21","2&3","2&8","2&34","2&1")

Fibo_3 <- quota(Fibo3,Fibo1,Fibo2,Fibo5,Fibo8,Fibo13, Fibo21, Fibo34,data_lotto_orig)
Fibo_3
colnames(Fibo_3) <- c("3&8","3&34","3&5","3&2","3&13","3&1","3&21")

Fibo_5 <- quota(Fibo5,Fibo2,Fibo3,Fibo1,Fibo8,Fibo13, Fibo21, Fibo34,data_lotto_orig)
Fibo_5
colnames(Fibo_5) <- c("5&34","5&3","2&2","5&1","5&21","5&8","5&13")

Fibo_8 <- quota(Fibo8,Fibo2,Fibo3,Fibo5,Fibo1,Fibo13, Fibo21, Fibo34,data_lotto_orig)
Fibo_8
colnames(Fibo_8) <- c("8&13","8&21","8&1","8&3","8&5","8&2","8&34")

Fibo_13 <- quota(Fibo13,Fibo2,Fibo3,Fibo5,Fibo8,Fibo1, Fibo21, Fibo34,data_lotto_orig)
Fibo_13
colnames(Fibo_13) <- c("13&8","13&2","13&1","13&34","13&3","13&21","13&5")

Fibo_21 <- quota(Fibo21,Fibo2,Fibo3,Fibo5,Fibo8,Fibo13, Fibo1, Fibo34,data_lotto_orig)
Fibo_21
colnames(Fibo_21) <- c("21&8","21&2","21&5","21&13","21&1","21&3","21&34")
 
Fibo_34 <- quota(Fibo34,Fibo2,Fibo3,Fibo5,Fibo8,Fibo13, Fibo21, Fibo1,data_lotto_orig)
Fibo_34
colnames(Fibo_34) <- c("34&5","34&1","34&13","34&3","34&8","34&2","34&21")
```

```{r Fibonacci-Zahlen Verteilung nach Rang,echo=FALSE, include=FALSE}
Fibo_1 #Fibonacci Zahl 1
Fibo_2 #Fibonacci Zahl 2
Fibo_3 #Fibonacci Zahl 3
Fibo_5 #Fibonacci Zahl 5
Fibo_8 #Fibonaci Zahl 8
Fibo_13 #Fibonacci Zahl 13
Fibo_21 #Fibonaci Zahl 21
Fibo_34 #Fibonacci Zahl 34
```
 
```{r Table1, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="left"}
table1 <- "

|                                               | Fibonacci Zahl 1 | Fibonacci Zahl 2 | Fibonacci Zahl 3 | Fibonacci Zahl 5 | Fibonacci Zahl 8 | Fibonacci Zahl 13 | Fibonacci Zahl 21 | Fibonacci Zahl 34 |
| :-------------------------------------------- | :--------------- | :--------------- | :--------------- | :--------------- | :--------------- | :--------------- | :--------------- | :--------------- |
|Fibonacci Zahl 1| |**59**|57|54|47|44|56|45|
|Fibonacci Zahl 2|**59**| |55|53|57|42|54|58|
|Fibonacci Zahl 3|57|55| |52|48|56|**57**|49|
|Fibonacci Zahl 5|54|53|52||55|**57**|54|45|
|Fibonacci Zahl 8|47|57|48|55||38|41|**57**|
|Fibonacci Zahl 13|44|42|56|**57**|38||56|47|
|Fibonacci Zahl 21|56|54|57|54|41|56||**63**|
|Fibonacci Zahl 34|45|58|49|45|57|47|**63**||

Table: Die Tabelle zeigt zeilenweise, welche Fibonacci-Zahlen im Lotto 6 aus 49 seit 1955 bis 2019 mit welchen Fibonacci-Zahlen wie häufig (in Ziehungen) gemeinsam gezogen wurden. Die häufigsten Beobachtungen wurden fett markiert. Es wird ersichtlich, dass die 1, 2, 21 und 34 am häufigsten mit ihren goldenen Schnitt Zahlen gezogen wurden.
"
cat(table1)
```

Aus Tabelle 1 ergibt sich die erste Hypothese: Die Fibonacci-Zahlen 1, 2, 21 und 34 werden unter allen Fibonacci-Zahlen im Lotto 6 aus 49 am häufigsten mit ihren goldenen Schnitt Zahlen gezogen.
<p>Die Verteilung der Wochentage im Lotto lässt sich anhand Abbildung 1 veranschaulichen. Betrachtet man die Häufigkeitsverteilung der Fibonacci-Zahlenpaare 1&2 sowie 21&34 hinsichtlich der Wochentage ergibt sich Abbildung 2.</p>

```{r fig.align="left",fig.cap="Die Lotto-Ziehungen von 1955 bis 2019 fanden am häufigsten samstags statt.",default= NULL,fig.height=3, fig.width=8}
gf_bar(~ Wochentag, data=data_lotto_orig, ncol=2, title="Lotto-Ziehungen")
```

```{r Häufigkeit Wochentage, echo=FALSE, include=FALSE}
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
library

Fibo1_2 <- rbind(Fibo1,Fibo2)
Fibo1_2 <- Fibo1_2[(which(duplicated(Fibo1_2))),]
nrow(Fibo1_2)
plot1 <- gf_bar(~ Wochentag, data = Fibo1_2, title = "Fibonacci 1 & 2")

Fibo21_34 <- rbind(Fibo21,Fibo34)
Fibo21_34 <- Fibo21_34[(which(duplicated(Fibo21_34))),]
nrow(Fibo21_34)
plot2 <- gf_bar(~ Wochentag, data = Fibo21_34, title = "Fibonacci 21 & 34")
```

```{r fig.align="left", fig.cap="Die Fibonacci Zahlen 1, 2, 21 und 34 werden samstags am häufigsten mit ihren Goldenen-Schnitt Zahlen gezogen.", default= NULL,fig.height=3, fig.width=8}
grid.arrange(plot1,plot2,ncol=2)
```
 

Die Häufigkeitsverteilungen können tabellarisch festgehalten werden. 
```{r relative Häufigkeiten, echo=FALSE, include=FALSE}
#relative Häufigkeit Ziehungen Fibonacci-Zahlenpaar 1&2 in Prozent
(59/4295)*100
#relative Häufigkeit Ziehungen Fibonacci-Zahlenpaar 21&34 in Prozent
(63/4295)*100
#absolute Anzahl Ziehungen Fibonacci-Zahlenpaar 1&2 samstags
Fibo1_2sa <- Fibo1_2%>%filter(Wochentag=="Samstag")
nrow(Fibo1_2sa)
#absolute Anzahl Ziehungen Fibonacci-Zahlenpaar 21&34 samstags
Fibo21_34sa <- Fibo21_34%>%filter(Wochentag=="Samstag")
nrow(Fibo21_34sa)
#absolute Anzahl Ziehungen samstags
Lotto_sa <- data_lotto_orig %>% filter(Wochentag=="Samstag")
nrow(Lotto_sa)
(nrow(Lotto_sa)/nrow(data_lotto_orig))*100
#relative Anzahl Ziehungen Fibonacci-Zahlenpaar 1&2 samstags in Prozent
(nrow(Fibo1_2sa)/nrow(Lotto_sa))*100
#relative Anzahl Ziehungen Fibonacci-Zahlenpaar 21&34 samstags in Prozent
(nrow(Fibo21_34sa)/nrow(Lotto_sa))*100

```

```{r Table2, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="c", }
table2 <- "

| Ereignis                                      | absolute Häufigkeit (Ziehungsanzahl) | relative Häufigkeit (in %) |
| :-------------------------------------------- | :----------------------------------- | :------------------------- |
| Samstagziehungen Gesamt                       | 2805                                 | 65.3085 %                  | 
| Fibonacci Zahlenpaar 1&2                      | 59                                   | 1.37369 %                  |
| Fibonacci Zahlenpaar 21&34                    | 63                                   | 1.466822 %                 | 
| Samstagziehungen Fibonacci Zahlenpaar 1&2     | 40                                   | 1.426025 %                 | 
| Samstagziehungen Fibonacci Zahlenpaar 21&34   | 38                                   | 1.354724 %                 | 
Table: Die Samstagsziehungen machen ca. 65% der Lottoziehungen aus. Das Fibonacci Zahlenpaar 21&34 wird um 4 zusätzliche Ziehungen häufiger als das Zahlenpaar 1&2 gezogen. Samstags wird das Zahlenpaar 1&2 um 2 Ziehugen häufiger als das Zahlenpaar 21&34 gezogen. Fibonacci-Zahlenpaare im Goldenen-Schnitt werden mit <1,5% relativ selten im Lotto 6 aus 49 gezogen.  
"
cat(table2)
```

Aus diesen Beobachtungen lässt sich die Hyothese ableiten, dass die Fibonacci Zahlen 1,2,21 und 34 samstags am häufigsten mit ihren Goldenen-Schnitt Zahlen gezogen werden.


## 3.3 deskriptive Statistik

Die deskriptive Statistik beschäftig sich mit den Lage- und Streuparametern des Datensatzes. Die Lagemaße spiegeln die Verteiung der Daten wieder, wohingegen die Streuungsmaße die Unterschiedlichkeiten in den Daten wiedergeben. [vgl.@sauer_moderne_2018, S.104-105] Die Lagemaße der Fibonacci Zahlenpaare 1&2 werden durch folgenden Boxplot gekennzeichnet (siehe Abbildung 3).

```{r,echo=FALSE, include=FALSE}

#favstats(~ GewZahl_1, data = Fibo1_2)
#favstats(~ GewZahl_2, data = Fibo1_2)
#favstats(~ GewZahl_3, data = Fibo1_2)
#favstats(~ GewZahl_4, data = Fibo1_2)
#favstats(~ GewZahl_5, data = Fibo1_2)
#favstats(~ GewZahl_6, data = Fibo1_2)
library("mosaic")
library(citr)
b1 <- gf_boxplot(~ GewZahl_1, data=Fibo1_2)
b2 <- gf_boxplot(~ GewZahl_2, data=Fibo1_2)
b3 <- gf_boxplot(~ GewZahl_3, data=Fibo1_2)
b4 <- gf_boxplot(~ GewZahl_4, data=Fibo1_2)
b5 <- gf_boxplot(~ GewZahl_5, data=Fibo1_2)
b6 <- gf_boxplot(~ GewZahl_6, data=Fibo1_2)
```
\newpage
```{r a,fig.height=4, fig.width=8, fig.cap="Betrachtet man die Reihenfolge der gezogenen Zahlen bei den Ziehungen der Fbonacci Zahlen 1\\&2, so lässt sich veranschaulichen, dass die Werte je nach Ziehungsrunde variieren. Die unteren 25\\% enthalten dabei immer (bis auf die dritte Gewinnzahl) die Ziffern 1 und 2.", echo=FALSE,default= NULL}
grid.arrange(b1,b2,b3,b4,b5,b6,ncol=3)
```


Die Mittelwerte, der Gewinnzahlen der Fibonacci Zahlenpaare 1&2 werden in Tabelle 3 dargestellt.
```{r Mittelwerte, echo=FALSE, include=FALSE}
mean(~ GewZahl_1, data = Fibo1_2)
mean(~ GewZahl_2, data = Fibo1_2)
mean(~ GewZahl_3, data = Fibo1_2)
mean(~ GewZahl_4, data = Fibo1_2)
mean(~ GewZahl_5, data = Fibo1_2)
mean(~ GewZahl_6, data = Fibo1_2)
```
 
```{r Table3, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="c",default= NULL }
table3 <- "

| Gewinnzahl   | Mittelwert |
| :----------- | :--------- | 
|Gewinnzahl 1|19.20339|
|Gewinnzahl 2|16.89831|
|Gewinnzahl 3|22.08475|
|Gewinnzahl 4|17.83051|
|Gewinnzahl 5|17.94915|
|Gewinnzahl 6|15.69492|
Table: Die Gewinnzahlen der Fibonacci-Ziehungspaare 1&2 unterscheiden sich in ihren Mittelwerten. Gewinnzahl 3 weist den größten Mittelwert mit 22.08475 auf, Gewinnzahl 6 den niedrigsten mit 15.69492.  
"
cat(table3)
```

Die Lagemaße der Fibonacci-Zahlen 21&34 werden durch die Abbildung 4 dargestellt.
```{r box,echo=FALSE, include=FALSE}

#favstats(~ GewZahl_1, data = Fibo1_2)
#favstats(~ GewZahl_2, data = Fibo1_2)
#favstats(~ GewZahl_3, data = Fibo1_2)
#favstats(~ GewZahl_4, data = Fibo1_2)
#favstats(~ GewZahl_5, data = Fibo1_2)
#favstats(~ GewZahl_6, data = Fibo1_2)
library("mosaic")
library(citr)
b7 <- gf_boxplot(~ GewZahl_1, data=Fibo21_34)
b8 <- gf_boxplot(~ GewZahl_2, data=Fibo21_34)
b9 <- gf_boxplot(~ GewZahl_3, data=Fibo21_34)
b10 <- gf_boxplot(~ GewZahl_4, data=Fibo21_34)
b11 <- gf_boxplot(~ GewZahl_5, data=Fibo21_34)
b12 <- gf_boxplot(~ GewZahl_6, data=Fibo21_34)
```

```{r c,fig.height=4, fig.width=8, fig.cap="Betrachtet man die Reihenfolge der gezogenen Zahlen bei den Ziehungen der Fbonacci Zahlen 1\\&2, so lässt sich veranschaulichen, dass die Werte je nach Ziehungsrunde variieren. Die unteren 25\\% enthalten dabei immer (bis auf die dritte Gewinnzahl) die Ziffern 1 und 2.", echo=FALSE,default= NULL}
grid.arrange(b7,b8,b9,b10,b11,b12,ncol=3)
```

Die Mittelwerte, der Gewinnzahlen der Fibonacci Zahlenpaare 21&34 werden in Tabelle 4 dargestellt.
```{r Mittelwerte2, echo=FALSE, include=FALSE}
mean(~ GewZahl_1, data = Fibo21_34)
mean(~ GewZahl_2, data = Fibo21_34)
mean(~ GewZahl_3, data = Fibo21_34)
mean(~ GewZahl_4, data = Fibo21_34)
mean(~ GewZahl_5, data = Fibo21_34)
mean(~ GewZahl_6, data = Fibo21_34)

```
 
```{r Table4, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="c",default= NULL}
table3 <- "

| Gewinnzahl   | Mittelwert |
| :----------- | :--------- | 
|Gewinnzahl 1|24.95238|
|Gewinnzahl 2|25.55556|
|Gewinnzahl 3|24.01587|
|Gewinnzahl 4|27.39683|
|Gewinnzahl 5|29.77778|
|Gewinnzahl 6|26.42857|
Table: Die Gewinnzahlen der Fibonacci-Ziehungspaare 21\\&34 unterscheiden sich in ihren Mittelwerten. Gewinnzahl 5 weist den größten Mittelwert mit 29.77778 auf, Gewinnzahl 3 den niedrigsten mit 24.01587.  
"
cat(table3)
```

Zur Bestimmung des Modus der Gewinnzahlen aus den Fibonacci-Zahlenpaaren 1&2 kann folgende Tabelle dargestellt werden.(siehe Tabelle 5)
```{r Modus1&2, echo=FALSE, include=FALSE}
count(Fibo1_2, GewZahl_1) %>% arrange(-n) %>% top_n(1)
count(Fibo1_2, GewZahl_2) %>% arrange(-n) %>% top_n(1)
count(Fibo1_2, GewZahl_3) %>% arrange(-n) %>% top_n(1)
count(Fibo1_2, GewZahl_4) %>% arrange(-n) %>% top_n(1)
count(Fibo1_2, GewZahl_5) %>% arrange(-n) %>% top_n(1)
count(Fibo1_2, GewZahl_6) %>% arrange(-n) %>% top_n(1)
```

```{r Table5, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="left",default= NULL }
table5 <- "

| Gewinnzahl   | Am häufigsten gezogene Zahl | Anzahl der Ziehungen |
| :----------- | :-------------------------- | :------------------- |
|Gewinnzahl 1|2|12x|
|Gewinnzahl 2|1&2|je 11x|
|Gewinnzahl 3|1&2|je 7x|
|Gewinnzahl 4|2|11x|
|Gewinnzahl 5|1|13x|
|Gewinnzahl 6|1|11x|
Table: Die Modi der Gewinnzahlen der Fibonacci-Ziehungspaare 1\\&2 unterscheiden sich in ihren Ziehungshäufigkeiten. Es wird ersichtlich, dass die Ziffern 1 und 2 in jeder Ziehung am häufigsten auftreten.  
"
cat(table5)
```

Zur Bestimmung des Modus der Gewinnzahlen aus den Fibonacci-Zahlenpaaren 21&34 kann folgende Tabelle dargestellt werden.(siehe Tabelle 6)
```{r Modus21&34, echo=FALSE, include=FALSE}
count(Fibo21_34, GewZahl_1) %>% arrange(-n) %>% top_n(1)
count(Fibo21_34, GewZahl_2) %>% arrange(-n) %>% top_n(1)
count(Fibo21_34, GewZahl_3) %>% arrange(-n) %>% top_n(1)
count(Fibo21_34, GewZahl_4) %>% arrange(-n) %>% top_n(1)
count(Fibo21_34, GewZahl_5) %>% arrange(-n) %>% top_n(1)
count(Fibo21_34, GewZahl_6) %>% arrange(-n) %>% top_n(1)
```

```{r Table6, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', fig.align="left",default= NULL }
table6 <- "

| Gewinnzahl   | Am häufigsten gezogene Zahl | Anzahl der Ziehungen |
| :----------- | :-------------------------- | :------------------- |
|Gewinnzahl 1|21|15x|
|Gewinnzahl 2|34|12x|
|Gewinnzahl 3|21|11x|
|Gewinnzahl 4|34|11x|
|Gewinnzahl 5|34|9x|
|Gewinnzahl 6|34|14x|
Table: Die Modi der Gewinnzahlen der Fibonacci-Ziehungspaare 1\\&2 unterscheiden sich in ihren Ziehungshäufigkeiten. Es wird ersichtlich, dass die Ziffern 1 und 2 in jeder Ziehung am häufigsten auftreten.  
"
cat(table6)
```

Um zu prüfen, ob die Gewinnzahlen der Fibonacci-Zahlenpaare 1&2 korrelieren wird vorab eine grafische Übersicht mittels des R-Befehls "gf_point" angewandt um Tendeznen des Zusammenhangs zu erkennen.

```{r Korrelation, include = FALSE, echo = FALSE}
kor1 <- gf_point(GewZahl_2~ GewZahl_1, data = Fibo1_2)
kor2 <- gf_point(GewZahl_3~ GewZahl_2, data = Fibo1_2)
kor3 <- gf_point(GewZahl_4~ GewZahl_3, data = Fibo1_2)
kor4 <- gf_point(GewZahl_5~ GewZahl_4, data = Fibo1_2)
kor5 <- gf_point(GewZahl_6~ GewZahl_5, data = Fibo1_2)
```

```{r Korrelation_1,fig.height=4, fig.width=8, fig.cap="Abbildung X zeigt, dass die Gewinnzahlen nicht von ihren vorheringen Gewinnzahlen abhängen. Somit besteht kein Zusammenhang zwischen den einzelnen Gewinnzahlen.", echo=FALSE,default= NULL}
grid.arrange(kor1, kor2, kor3, kor4, kor5)
```

Die Korrelationskoeffizienten zeigen keinen Zusammenhang der Gewinnzahlen wie anhand Tabelle 6 veranschaulicht wird [vgl. @sauer_moderne_2018, S.112]. 

```{r Cor, echo=FALSE, include = FALSE}
cor1 <- cor(GewZahl_2~ GewZahl_1, data = Fibo1_2)
cor2 <- cor(GewZahl_3~ GewZahl_2, data = Fibo1_2)
cor3 <- cor(GewZahl_4~ GewZahl_3, data = Fibo1_2)
cor4 <- cor(GewZahl_5~ GewZahl_4, data = Fibo1_2)
cor5 <- cor(GewZahl_6~ GewZahl_5, data = Fibo1_2)
```

```{r Table7, echo=FALSE, message=FALSE, warnings=FALSE, results='asis'}
table7 <- "

| Unabhängige Variable   | Abhängige Variable | Korrelationskoeffizient |
| :--------------------- | :----------------- | :---------------------- |
|Gewinnzahl 1|Gewinnzahl 2|-0.21260081|
|Gewinnzahl 2|Gewinnzahl 3|-0.03212074|
|Gewinnzahl 3|Gewinnzahl 4|-0.2106801|
|Gewinnzahl 4|Gewinnzahl 5| -0.07762|
|Gewinnzahl 5|Gewinnzahl 6|-0.05135401|

Table: Die Korrelationskoeffizienten der Gewinnzahlen liegen nahe bei Null. Es kann kein Zusammenhang unter den Gewinnzahlen festgehalten werden.  
"
cat(table7)
```

\newpage
## 3.4 Inferenzstatistik 
Da sich die bisherige Datenanlyse auf eine einzige Stichprobe bezieht, ist fraglich, wie aussagekräftig die Stichprobe für das Verhalten der Fibonacci-Zahlen im Goldenen Schnitt Verhältnis im Lotto 6 aus 49 ist. [vgl.@sauer_moderne_2018, S.268]
Mittels der simualtionsbasierten Inferenz und dem Resampling ist es möglich, die Genauigkeit des geschätzten Wertes mittels Bootstrapping und einem Konfidenzintervall zu quantifizieren.[vgl.@sauer_moderne_2018, S.310]
Zum Testen der Hypothesen wird die Nullhypothese durch den hypothetischen Wert (siehe Einleitung) sowie durch das Resamplingverfahren mittels Permutation abgebildet. [vgl.@siebertz_statistische_2017, S.384]
Mittels linearen Regression soll anschließen überprüft werden, ob Werte mittels einer Geraden prophezeit werden können.[vgl.@sauer_moderne_2018, S.322]  

### 3.4.1 Bootstrap
Um die Hypothese prüfen zu können wird im ersten Schritt aus der bereits vorhanden Stichprobe eine Stichprobenverteilung vom Umfang n = 10.000 Stichproben erstellt. Hierzu wird mittels R-Skript "_03_Bootstrap_Lotto_Gesamt.R" die vorhandene Stichprobe mit 4295 Ziehungen mit Zurücklegen zufällig neu gezogen. Die neu gezogene Stichprobe wird danach auf die Häufigkeitsverteilung der Fibonacci-Zahlenpaare 1&2 sowie 21&34 untersucht. Dieser Vorgang wird 10.000 mal wiederholt. Dabei werden auch die Wochentage berücksichtigt. In Form von Balkendiagrammen werden die Verteilungshäufigkeiten grafisch dargestellt.



```{r Bootstrap, include=FALSE, echo=FALSE}

# Quotenverteilung der Originalstichprobe

Lotto_Fibo_1_2 <- read.csv2("Lotto_Quota_Fibo_1_2.csv", header = FALSE)
colnames(Lotto_Fibo_1_2) <- c("Anteil","Ziehungsanzahl","Ziehungen Mittwoch","Ziehungen Samstag","Ziehungen andere Tage")
Lotto_Fibo_21_34 <- read.csv2("Lotto_Quota_Fibo_21_34.csv",header = FALSE)
colnames(Lotto_Fibo_21_34) <- c("Anteil","Ziehungsanzahl","Ziehungen Mittwoch","Ziehungen Samstag","Ziehungen andere Tage")

# Quotenverteilung der Bootstrap-Stichproben

Bootstrap_Fibo_1_2 <- read.csv2("Bootstrap_Quota_Fibo_1_2.csv")
colnames(Bootstrap_Fibo_1_2) <- c("Anteil","Ziehungsanzahl","Ziehungen_Mittwoch","Ziehungen_Samstag","Ziehungen_andere_Tage")
Bootstrap_Fibo_21_34 <- read.csv2("Bootstrap_Quota_Fibo_21_34.csv")
colnames(Bootstrap_Fibo_21_34) <- c("Anteil","Ziehungsanzahl","Ziehungen_Mittwoch","Ziehungen_Samstag","Ziehungen_andere_Tage")

# Grafik der Verteilungshäufigkeiten Fibonacci 1&2 inkl. IQR anzeigen lassen.
Lotto_Fibo_1_2
draw1_2 <- Lotto_Fibo_1_2[,2]
draw1_2
q1_2 <- quantile( ~ Ziehungsanzahl, probs = c(0.025, 0.975), data = Bootstrap_Fibo_1_2)
q1_2 <- as.data.frame(q1_2)
q1_2a <- q1_2[1,1]
q1_2b <-q1_2[2,1]
q1_2
Bootsvertlg_1_2 <- gf_bar(~Ziehungsanzahl, data = Bootstrap_Fibo_1_2,title = "Bootstrap Verteilung Fibonacci 1&2") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(q1_2a,q1_2b,draw1_2))
mean(Bootstrap_Fibo_1_2$Ziehungsanzahl)

# Anteilswert auf häufigsten Anteil testen
Anteil_Boot_1_2 <- gf_bar(~ Anteil, data = Bootstrap_Fibo_1_2, binwidth = 8)%>% gf_vline(colour=c("red"), xintercept =c(0.0118742724097788))
Anteil_Boot_1_2
as.numeric(Bootstrap_Fibo_1_2$Anteil)
sort(tally(Bootstrap_Fibo_1_2$Anteil))

# Grafik der Verteilungshäufigkeiten Fibonacci 1&2 inkl. IQR hinsichtlich samstagsziehung anzeigen lassen.
Lotto_Fibo_1_2
draw1_2a <- Lotto_Fibo_1_2[,4]
draw1_2a
q1_2a <- quantile( ~ Ziehungen_Samstag, probs = c(0.025, 0.975), data = Bootstrap_Fibo_1_2)
q1_2a <- as.data.frame(q1_2a)
q1_2a
q1_2c <- q1_2a[1,1]
q1_2d <-q1_2a[2,1]
Bootsvertlg_1_2sa <- gf_bar(~Ziehungen_Samstag, data = Bootstrap_Fibo_1_2, title = "Bootstrap Verteilung Fibonacci 1&2 - Samstagsziehungen") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(q1_2c,q1_2d,draw1_2a))
Bootsvertlg_1_2sa
mean(Bootstrap_Fibo_1_2$Ziehungen_Samstag)


# Grafik der Verteilungshäufigkeiten Fibonacci 21&34 inkl. IQR anzeigen lassen.
Lotto_Fibo_21_34
draw21_34 <- Lotto_Fibo_21_34[,2]
draw21_34
q21_34 <- quantile( ~ Ziehungsanzahl, probs = c(0.025, 0.975), data = Bootstrap_Fibo_21_34)
q21_34 <- as.data.frame(q21_34)
q21_34
q21_34a <- q21_34[1,1]
q21_34b <-q21_34[2,1]
Bootsvertlg_21_34 <- gf_bar(~Ziehungsanzahl, data = Bootstrap_Fibo_21_34) %>% gf_vline(colour=c("black","black", "red"), xintercept =c(q21_34a,q21_34b,draw21_34))
Bootsvertlg_21_34
mean(Bootstrap_Fibo_21_34$Ziehungsanzahl)

# Grafik der Verteilungshäufigkeiten Fibonacci 21&34 inkl. IQR hinsichtlich samstagsziehung anzeigen lassen.
Lotto_Fibo_21_34
draw1_2b <- Lotto_Fibo_21_34[,4]
draw1_2b
q1_2b <- quantile( ~ Ziehungen_Samstag, probs = c(0.025, 0.975), data = Bootstrap_Fibo_21_34)
q1_2b <- as.data.frame(q1_2b)
q1_2b
q1_2e <- q1_2a[1,1]
q1_2f <-q1_2a[2,1]
Bootsvertlg_21_34sa <- gf_bar(~Ziehungen_Samstag, data = Bootstrap_Fibo_21_34, title = "Bootstrap Verteilung Fibonacci 1&2 - Samstagsziehungen") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(q1_2f,q1_2e,draw1_2b))
Bootsvertlg_21_34sa
mean(Bootstrap_Fibo_21_34$Ziehungen_Samstag)
```

Die Bootstrapverteilung der Fibonacci-Zahlenpaare 1 und 2 kann anhand Abbildung XY visualisiert werden.

```{r Bootstrap_1_2, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 1 und 2 40 mal gezogen und in 75\\% der Stichprobenverteilungen 68 mal (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 59 auf (rote Linie). Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Bootsvertlg_1_2, title = "Bootsverteilung der Fibonacci Zahlenpaare 1 und 2")
```

Die Bootstrapverteilung der Fibonacci-Zahlenpaare 21 und 34 kann anhand Abbildung XY visualisiert werden.
```{r Bootstrap_21_34, fig.cap ="In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 21 und 34 37 mal gezogen und in 75\\% der Stichprobenverteilungen 64 mal (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 63 auf (rote Linie) Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Bootsvertlg_21_34,title = "Bootsverteilung der Fibonacci Zahlenpaare 21 und 34")
```

Die Bootstrapverteilung der Fibonacci-Zahlenpaare 1 und 2 samstags kann anhand Abbildung XY visualisiert werden.
```{r Bootstrap_1_2sa, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 1\\&2 samstags 24 mal und in 75\\% der Stichprobenverteilungen 47 mal gezogen (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 40 Samstagsziehungen auf (rote Linie). Dieser Wert liegt innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Bootsvertlg_1_2sa,title = "Bootsverteilung der Fibonacci Zahlenpaare 1&2 - Samstag")
```

Die Bootstrapverteilung der Fibonacci-Zahlenpaare 21 und 34 samstags kann anhand Abbildung XY visualisiert werden.
```{r Bootstrap_21_34sa, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 21 und 34 samstags 22 mal und in 75\\% der Stichprobenverteilungen 44 mal gezogen (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 38 Samstagsziehungen auf (rote Linie). Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Bootsvertlg_21_34sa,title = "Bootsverteilung der Fibonacci Zahlenpaare 1&2 - Samstag")
```

Aus den Grafiken geht hervor, dass sowohl H1 als auch H2 verworfen werden können.


### 3.4.2 Permutation
Mittels der Permutation wird die Nullhypothese simuliert. Hierzu werden zufällig 6 Ziffern aus den vorgegebenen Ziffern 1-49 ohne Zurücklegen gezogen. Die Wochentage werden ebenso ohne Effekt zufällig ohne Zurücklegen gezogen. Der hypothetische Wert wird ebenso in einem zweiten Schritt zu Hypothesentestung verwendet.


```{r Permutation, include=FALSE, echo=FALSE}

# Quotenverteilung der Permutations-Stichproben

Permutation_Fibo_1_2 <- read.csv2("Permutation_Quota_Fibo_1_2.csv")
colnames(Permutation_Fibo_1_2) <- c("Anteil","Ziehungsanzahl","Ziehungen_Mittwoch","Ziehungen_Samstag","Ziehungen_andere_Tage")
Permutation_Fibo_21_34 <- read.csv2("Permutation_Quota_Fibo_21_34.csv")
colnames(Permutation_Fibo_21_34) <- c("Anteil","Ziehungsanzahl","Ziehungen_Mittwoch","Ziehungen_Samstag","Ziehungen_andere_Tage")

# Grafik der Verteilungshäufigkeiten Fibonacci 1&2 inkl. IQR anzeigen lassen.
Lotto_Fibo_1_2
draw1_2 <- Lotto_Fibo_1_2[,2]
draw1_2
pq1_2 <- quantile( ~ Ziehungsanzahl, probs = c(0.025, 0.975), data = Permutation_Fibo_1_2)
pq1_2 <- as.data.frame(pq1_2)
pq1_2h <- pq1_2[1,1]
pq1_2b <-pq1_2[2,1]
pq1_2
Permutvtlg_1_2 <- gf_bar(~Ziehungsanzahl, data = Permutation_Fibo_1_2,title = "Permutation Verteilung Fibonacci 1&2") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(pq1_2h,pq1_2b,draw1_2))
Permutvtlg_1_2
mean(Permutation_Fibo_1_2$Ziehungsanzahl)

# Anteilswert auf häufigsten Anteil testen
Anteil_Boot_1_2 <- gf_bar(~ Anteil, data = Bootstrap_Fibo_1_2, binwidth = 8)%>% gf_vline(colour=c("red"), xintercept =c(0.0118742724097788))
Anteil_Boot_1_2
as.numeric(Bootstrap_Fibo_1_2$Anteil)
sort(tally(Bootstrap_Fibo_1_2$Anteil))

# Grafik der Verteilungshäufigkeiten Fibonacci 1&2 inkl. IQR hinsichtlich samstagsziehung anzeigen lassen.
Lotto_Fibo_1_2
draw1_2a <- Lotto_Fibo_1_2[,4]
draw1_2a
pq1_2a <- quantile( ~ Ziehungen_Samstag, probs = c(0.025, 0.975), data = Permutation_Fibo_1_2)
pq1_2a <- as.data.frame(pq1_2a)
pq1_2a
pq1_2c <- pq1_2a[1,1]
pq1_2d <-pq1_2a[2,1]
Permutvertlg_1_2sa <- gf_bar(~Ziehungen_Samstag, data = Permutation_Fibo_1_2, title = "Permutation Verteilung Fibonacci 1&2 - Samstagsziehungen") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(pq1_2c,pq1_2d,draw1_2a))
Permutvertlg_1_2sa
mean(Permutation_Fibo_1_2$Ziehungen_Samstag)


# Grafik der Verteilungshäufigkeiten Fibonacci 21&34 inkl. IQR anzeigen lassen.
Lotto_Fibo_21_34
draw21_34 <- Lotto_Fibo_21_34[,2]
draw21_34
pq21_34 <- quantile( ~ Ziehungsanzahl, probs = c(0.025, 0.975), data = Permutation_Fibo_21_34)
pq21_34 <- as.data.frame(pq21_34)
pq21_34
pq21_34a <- pq21_34[1,1]
pq21_34b <-pq21_34[2,1]
Permutvertlg_21_34 <- gf_bar(~Ziehungsanzahl, data = Permutation_Fibo_21_34,title = "Permutation Verteilung Fibonacci 21&34") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(pq21_34a,pq21_34b,draw21_34))
Permutvertlg_21_34
mean(Permutation_Fibo_21_34$Ziehungsanzahl)

# Grafik der Verteilungshäufigkeiten Fibonacci 21&34 inkl. IQR hinsichtlich Samstagsziehung anzeigen lassen.
Lotto_Fibo_21_34
draw21_34b <- Lotto_Fibo_21_34[,4]
draw21_34b
pq21_34b <- quantile( ~ Ziehungen_Samstag, probs = c(0.025, 0.975), data = Permutation_Fibo_21_34)
pq21_34b <- as.data.frame(pq21_34b)
pq21_34b
pq21_34e <- pq21_34b[1,1]
pq21_34f <-pq21_34b[2,1]
Permutvertlg_21_34sa <- gf_bar(~Ziehungen_Samstag, data = Bootstrap_Fibo_21_34, title = "Bootstrap Verteilung Fibonacci 21&34 - Samstagsziehungen") %>% gf_vline(colour=c("black","black", "red"), xintercept =c(pq21_34f,pq21_34e,draw21_34b))
Permutvertlg_21_34sa
mean(Permutation_Fibo_21_34$Ziehungen_Samstag)
```

Die Permutationsverteilung der Fibonacci-Zahlenpaare 1 und 2 kann anhand Abbildung XY visualisiert werden.

```{r Permut_1_2, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 1\\&2 40 mal gezogen und in 75\\% der Stichprobenverteilungen 68 mal (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 59 auf (rote Linie). Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Permutvtlg_1_2, title = "Permutationsverteilung der Fibonacci Zahlenpaare 1&2")
```

Die Permutationsverteilung der Fibonacci-Zahlenpaare 21 und 34 kann anhand Abbildung XY visualisiert werden.
```{r Permut_21_34, fig.cap ="In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 21\\&34 37 mal gezogen und in 75\\% der Stichprobenverteilungen 64 mal (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 63 auf (rote Linie) Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Permutvertlg_21_34,title = "Permutationsverteilung der Fibonacci Zahlenpaare 21&34")
```

Die Permutationsverteilung der Fibonacci-Zahlenpaare 1 und 2 samstags kann anhand Abbildung XY visualisiert werden.
```{r Permut_1_2sa, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 1\\&2 samstags 24 mal und in 75\\% der Stichprobenverteilungen 47 mal gezogen (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 40 Samstagsziehungen auf (rote Linie). Dieser Wert liegt innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Permutvertlg_1_2sa,title = "Permutationsverteilung der Fibonacci Zahlenpaare 1&2 - Samstag")
```

Die Permutationsverteilung der Fibonacci-Zahlenpaare 21 und 34 samstags kann anhand Abbildung XY visualisiert werden.

```{r Permut_21_34sa, fig.cap =  "In 25\\% der Stichprobenverteilungen des Bootstrap Resamplings wurden die Fibonacci-Zahlen 21 und 34 samstags 22 mal und in 75\\% der Stichprobenverteilungen 44 mal gezogen (schwarze Linien). Der p-Wert der Originalstichprobe weist eine Ziehungsanzahl von 38 Samstagsziehungen auf (rote Linie). Dieser Wert liegt noch innerhalb der Quantile und stellt somit einen plausiblen Wert dar. Die Nullhypothese wird zum Signifikanzniveau von 95\\% angenommen.", echo=FALSE}
plot(Permutvertlg_21_34sa,title = "Permutationsverteilung der Fibonacci Zahlenpaare 21&34 - Samstag")
```



### 3.4.3 Lineare Regression

Anhand der linearen Regression kann erklärt werden, ob die Gewinnzahlen durch andere   

```{r lineare Regression}
# Residuenanalyse [Hier erkennbar, dass Ausgabe der Linearen Regression feherhaft, da kein
#linearer Zusammenhang] 

# Zusammenhang der Gewinnzahlen 2&1
Regress1 <- lm(GewZahl_2 ~ GewZahl_1, data = Fibo1_2)
Regress1co <- lm(GewZahl_2 ~ GewZahl_1 + GewZahl_3 + GewZahl_4 + GewZahl_5 + GewZahl_6 , data = Fibo1_2)
Regress1coges <- lm(GewZahl_2 ~ GewZahl_1 + GewZahl_3 + GewZahl_4 + GewZahl_5 + GewZahl_6 , data = data_lotto_orig)

summary(Regress1)
summary(Regress1co)
summary(Regress1coges)

par(mfrow = c(2,2))
Regress1PLot <- ggplot(data = Regress1, mapping = aes(x = GewZahl_1, y = GewZahl_2)) + geom_point() + geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")
Regress1PLot

# Zusammenhang der Gewinnzahlen 3&2
Regress2 <- lm(GewZahl_3 ~ GewZahl_2, data = Fibo1_2)
Regress2co <- lm(GewZahl_3 ~ GewZahl_2 + GewZahl_1 + GewZahl_4 + GewZahl_5 + GewZahl_6 , data = Fibo1_2)

summary(Regress2)
summary(Regress2co)

par(mfrow = c(2,2))
Regress2PLot <- ggplot(data = Regress2, mapping = aes(x = GewZahl_2, y = GewZahl_3)) + geom_point() + geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")
Regress2PLot

# Zusammenhang der Gewinnzahlen 4&3
Regress3 <- lm(GewZahl_4 ~ GewZahl_3, data = Fibo1_2)
summary(Regress3)
par(mfrow = c(2,2))
Regress3PLot <- ggplot(data = Regress3, mapping = aes(x = GewZahl_3, y = GewZahl_4)) + geom_point() + geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")
Regress3PLot


# Zusammenhang der Gewinnzahlen 5&4
Regress4 <- lm(GewZahl_5 ~ GewZahl_4, data = Fibo1_2)
summary(Regress4)
par(mfrow = c(2,2))
Regress4PLot <- ggplot(data = Regress4, mapping = aes(x = GewZahl_4, y = GewZahl_5)) + geom_point() + geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")
Regress4PLot

# Zusammenhang der Gewinnzahlen 6&5
Regress5 <- lm(GewZahl_6 ~ GewZahl_5, data = Fibo1_2)
summary(Regress5)
par(mfrow = c(2,2))
Regress5PLot <- ggplot(data = Regress5, mapping = aes(x = GewZahl_5, y = GewZahl_6)) + geom_point() + geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")
Regress5PLot

grid.arrange(Regress1PLot,Regress2PLot,Regress3PLot,Regress4PLot,Regress5PLot)


# p-Wert > alpha -> hoch (kein Zusammenhang), R2 sehr klein (schlechtes Modell) --> es erfolgt durch GewZahl2 keine Erklärung von GewZahl1
```







Gehen Sie hier näher auf die *verwendeten* Variablen ein. In R markdown Dateien können Sie einfach den R Code in Chunks einfügen (sogenannte "Code Chunks"). Entweder über das Menü `Insert -> R` oder über die Tastenkombination `strg+alt+i`. 


Hier stellen und beschreiben Sie die Ergebnisse Ihrer kleinen Studie. Ihre Ergebnisse stellen Sie graphisch und/ oder tabellarisch dar.
Ganz allgemein wird im Resultateteil NICHT interpretiert, sondern die Ergebnisse ausschließlich beschrieben.

Der Ergebnisteil kann zur besseren Orientierung und zum besseren Lesen weitere Gliederungspunkte enthalten (z.B. bei Hypothesenwechsel, für jedes Ergebnis o.ä.).

* die Abbildungen werden durchnummeriert  (Abbildung 1 bis Abbildung xx) ebenso die Tabellen.
* Jede Abbildung erhält eine Bildunterschrift und jede Tabelle eine Beschreibung (über der Tabelle).
  - die Bildunterschrift dürfen Sie mit R markdown machen oder aber in word! Eine Vorlage für eine Bildunterschrift ist im Template enthalten.

Beispiel für Ergebisbeschreibung und einer Figure caption  = Bildunterschrift:


<br>
```{r fig.cap =  "Die Kelchblattlängen der untersuchten Spezies der Schwertlilien unterscheiden sich signifikant. Dargestellt sind die Kelchblattlängen der drei Spezies der Schwertlilien (iris versicolor, iris setosa und iris virginica). Sie Kelchblattlängen zeigen unterschiedliche Längen, wobei iris setosa die kürzesten und Iris virginica die längsten Kelchblätter zeigt.p= x.xxx", fig.height=4, fig.width=4 } 

#boxplot (Sepal.Length ~Species , data = iris)
```



Die Ergebnisse graphisch und tabellarisch dargestellt. Eine tabellarische Darstellung der Ergebnisse ist im Teil der deskriptiven Statistik oft sinnvoll.
Sie entscheiden hier was eine sinnvolle Darstellung ist!
 
</br>
Beschreiben Sie das zentrale Ergebnis und Auffälligkeiten.


**Folgendes sollte im Ergebnisteil enthalten/ ver- oder beararbeitet sein: **
  1. Kennzahlen
  2. explorative / deskriptive Statistik
  3. Inferenzstatistik
  
 

Beschreiben Sie Ihre Stichprobe und Ihre Variablen. 
Das ist hilfreich zum Verständnis und Nachvollziehbarkeit Ihrer Studie, der Datenerhebung und der Hypothesentestung.  



Gehen Sie hier genauer auf die untersuchten Hypothesen und Modelle ein. Geben Sie zur Methodik 1-3 Literaturquellen an.  

```{r fig.cap="Hier steht Ihre Bildunterschrift zur Abbildung im gleichen Chunk. Damit die Bildunterschrift passend zur Abb ausgegeben wird, ist nur eine Abb. und eine Bildunterschrift pro Chunk möglich."}
# Exemplarisches Beispiel
#reg <- lm(tip ~ total_bill, data=tips)
#plotModel(reg)

```


# 4. Diskussion
Für die Diskussion setzen Sie das Ergebnis in Kontext zu bereits publizierter Literatur! (hier ist das Lesen und die Angabe (CAVE: richtig zitieren) von Literatur notwendig) Mind. 3 Literaturquellen

# 5. Schlussfolgerungen


<p>"Es steckt oft mehr Geist und Scharfsinn in einem Irrtum als in einer Entdeckung." - Joseph Joubert </p>

Fassen Sie hier kurz die zentralen Ergebnisse für Ihre Forschungsthematik zusammen. Gehen Sie auch auf die Grenzen Ihrer Analyse ein.

# Literaturverzeichnis

Hier stehen die im Text verwendeten Quellen:

- Nachname Autor1, Anfangsbuchstabe Vorname Autor1, Nachname Autor2, Anfangsbuchstabe Vorname Autor2 1 & Nachname Autor3, Anfangsbuchstabe Vorname Autor3, ... (Jahr der Veröffentlichung). Titel des Beitrags. Journal, Volume, Issue, Seitenzahlen
